---
layout: post
title: "배반, 조건부 확률과 독립"
author-id: "Cornelii. G. Son"
tags: [study, statistics]
updated: "2020-02-22"
chapter: "1-2"
en_title: "conditional probability, Disjoint, Independent "
---

## 배반과 독립

예전에 확률 사상의 배반과 독립의 관계는 항상 이해한 것 같다가도 다시 헤깔리는 귀찮은 녀석들이었다. 다시 한 번, 정리하면서 살펴보고자 한다.


`배반 (Disjoint)`, `독립 (Independent)`은 사상 (Events) 간의 관계에 대한 개념이다.  

결론부터 말하면, 사상 A와 사상 B가 있을 때,  
<br/>
배반은 $$ A \cap B \subset \phi $$,  
독립은 $$ P(A \cap B) = P(A)P(B) $$  
을 만족하는 관계라고 말할 수 있다.  
<br/>
먼저, `배반`에 대해서 살펴보자.  

<br/>

#### 배반

사실 **배반**은 그리 어렵지 않은 개념이다.
동시에 일어날 수 없는 사상 간의 관계를 말한다, 표본 공간 (Sampling Space)에서 사상 간의 교집합이 없는 것이다.
<br/>  
밑의 그림과 같은 관계이다.

<img src="/assets/img/statistics/01/1_2_1.png" alt="Disjoint" width="300"/>

<br/>

위 그림 처럼 표본공간에 임의의 사상 A와 사상 B가 있을 때,  
$$ P(A \cap B)$$와 $$P(A \cup B) $$
를 간단히 살펴보자.

<br/>
먼저, 확률의 가법 정리(Additive Rule) 즉, 더하기 법칙은 아래와 같다.   
<br/> 

$$ P(A \cup B) = P(A) + P(B) - P(A \cap B) $$


<br/>

$$ A \cap B $$
는 사상 `A 그리고 B` 즉, A와 B를 동시에 만족하는 경우이다.

<br/>

배반의 정의에 따라 $$ A \cap B = \phi $$ 이며, 

사상이 없는 확률은 0이기 떄문에, $$P(A \cap B) = P(\phi) = 0$$이 된다.
 <br/>
 <br/>
$$ A \cup B $$
는 `A 또는 B`가 일어날 사상을 말한다.  
좀 더 풀어 말해서, A가 일어나든 B가 일어나든 A, B가 함께 포함되든 A, B 두 사상 중 한 개 이상을 만족하는 경우이다.  <br/><br/>
이 경우의 확률은, 앞 서 
$$P(A \cap B) = 0$$ 
이기에,  
<br/> 가법 정리를 따라, 
$$ P(A \cup B) = P(A) + P(B) $$
가 된다.
<br/>  
<br/>

<br/>
<br/>
#### 관계가 없는 두 표본 공간의 결합 확률  

조건부 확률과 독립에 대해 이야기를 나누기 전에, 먼저 아래 그림의 확률을 생각해보자.
<br/>

<img src="/assets/img/statistics/01/1_2_2.png" alt="Disjoint" width="500"/>

<br/>
만약 서로 다른 표본 공간 S1과 S2에서 각각 사상 A1, A2가 함께 일어날 확률은 어떻게 표현할 수 있을까?

<br/>

$$ P_{S1,S2}(A1, A2) = P_{S1}(A1) * P_{S2}(A2)$$  

먼저, 위의 식과 같이 각각의 확률을 곱한 경우를 생각해 볼 수 있다.  
(이 때, 표본 공간 S1과 S2에서 가중치(확률)를 매기는 방식이 다를 수 있지만,
S1, S2를 함께 다룰 때의 $$P_{S1,S2}$$ 자체를 각각의 가중치 산정 방식으로 정해진 결합확률로 생각할 수 있다. 일종의 단위 *Unit* 처럼)  

그렇다면, 이게 타당한 셈법일지, 좀 더 생각해보자.  

표본 공간 S1에 속한 각각의 원소들의 확률을 아래와 같이 나타낸다면,  
$$ P_{s1}(A_i) = p_{s1}i$$
<br/>  
확률의 정의에 따라 다음식이 만족한다.  
$$  \sum_{i \subset S1} p_{s1}i = 1$$, $$ 0 <= p_{s1}i <= 1$$
<br/>
<br/>
마찬가지로 S2도 똑같이 나타낼 수 있다.
<br/>
$$  \sum_{i \subset S2} p_{s2}i = 1$$, $$ 0 <= p_{s2}i <= 1$$
<br/>
<br/>
이제, S1의 원소로부터 모든 확률의 합과, S2의 원소로부터 모든 확률의 합을 곱해서 결합확률 $$P_{S1,S2}$$를 생각해보자.
<br/>
<br/>
$$ 
\begin{aligned}
    (\sum_{i}^{n}p_{s1}i)*(\sum_{j}^{m}p_{s2}j) &= p_{s1}1*p_{s2}1 + p_{s1}1*p_{s2}2 + p_{s1}1*p_{s2}3 + ... + p_{s1}n*p_{s2}m \\
    &= P_{S1,S2}(1,1) + P_{S1,S2}(1,2) + P_{S1,S2}(1,3) + ... + P_{S1,S2}(n,m) \\
    &= 1
\end{aligned}    
$$
<br/>
$$ p_{s1}$$
들의 합과 
$$ p_{s2}$$
들의 합이 각각 1이므로 이 합들을 곱했기 떄문에 1이 되게 된다.
<br/>
<br/>
또, 중간에 나열한 항들을 살펴보면 모든 결합확률을 포함하고 있다.
<br/>
자연스럽게 확률의 조건을 만족하게 되면서!

<br/>
<br/>
$$ \sum_{i \subset S1}\sum_{j \subset S2}P_{S1,S2}(i,j) = 1, 0 <= P_{S1,S2}(i,j) <= 1$$
<br/>
<br/>
이렇게 서로 다른 표본공간의 확률의 곱을 적절히 정의하였다.
<br/>
이는 잠시 뒤에, `독립` 관계를 이해하는데 큰 도움이 될 수 있으니 기억해두자.
<br/>
<br/>

<br/>
<br/>
#### 조건부 확률

다음은 조건부 확률에 대해서 생각해보자!  
우리가 익숙한 조건부 확률 식을 먼저 보면,  
<br/>
$$ P(A|B) = P(A \cap B)/P(B)$$  
위와 같은 형태이다.  
<br/>
$$ P(A|B) $$
는 사상 B가 일어났을 때, 사상 A가 일어날 확률이다.  
사실, 이 말도 잘 와닿지 않을 수 있다.  밑의 그림을 보고 더 생각해보자. 
<br/>

<img src="/assets/img/statistics/01/1_2_3.png" alt="Disjoint" width="700"/>

<br/>
<br/>
1. 표본 공간 S에서 사상 B가 일어나는 경우와  
2. 표본 공간?! B 에서 A가 일어나는 경우를 함께 고려해보니  
3. 결국
$$A \cap B$$
를 표본 공간 S에서 뽑은 셈이 된다.  
이렇게 조건부 확률의 식을 생각해 볼 수 있다.  
<br/>
몇 가지만 더 생각해보면,  

$$ P(A|B) $$
는 사상 B가 일어났을 때, 사상 A가 일어날 확률이라는 말에서  
`사상 B가 일어났을 때`이 의미하는 것은, 표본 공간을 B로 줄인 상태에서 고려하겠다는 말이다!  
<br/>
더 재밌는 것은, 조건부 확률 식에 따라 생각해보면  단순한 사상 A가 일어날 확률을 다음처럼 표현할 수 있다.  

$$ P(A) = P(A|S) $$  
즉, 표본공간 S가 발생했을 때 A가 일어날 확률!  
(
    $$P(S) = 1$$
    ,
    $$P(S \cap A) = P(A)$$
    이므로
)
<br/>
<br/>
<br/>
<br/>

#### 독립
드디어, 독립을 다시 볼 때가 되었다~~!  

사실, 독립의 좀 더 명확한 정의는 다음과 같다.  

만약 사상 A와 B가 독립이라면,  

$$ P(A|B) = P(A) $$
가 되고, <span style="color:red">반대도 마찬가지다.</span>
$$ P(B|A) = P(B) $$  
<br/>
<span style="color:red">(이게 베이즈 정리다.)</span>
<br/>
<br/>
말로 풀어서 생각해보면, B가 일어나든 말든 A는 동일한 가중치로 일어난다!는 말이다.  
<br/>
조금만 생각해보면,  
$$P(A \cap B) = P(A)P(B)$$ 
와 
$$ P(A|B) = P(A) $$
가 동일한 것인지 알 수 있다.  
<br/>
<br/>
거의 끝났다~! 조금만 더 생각해보자!!  

맨 처음의 `독립`을 나타내는 식(
$$P(A \cap B) = P(A)P(B)$$ 
)을 보고 문득 드는 생각은?!  
두 표본공간의 결합확률이 떠올랐을 수 있을 것이다.  
<br/>
그렇다, 사상이 `독립`이라는 말은 각각의 표본공간으로 나누어 생각할 수 있다는 말이다.  
<br/>
이 어려운? 말은 마지막에 조금 더 설명해보고자 한다.  
<br/>

<br/>
그렇다면,
$$ P(A) = P(A|S) $$
를 어떻게 받아들일 수 있을까?  
표본공간 S와 그의 부분집합 A가 `독립`관계라고?!!  
<br/>
다시, 미궁속으로?!  
<br/>
<br/>
일단, 정의와 일치하니 맞는 말인 것 같다.  
이를 이해하기 위해 사상A와 B에 대한 독립관계식을 구체화하면,  
<br/>
$$P(A|S) = P(A|B)$$
표본공간 S에서의 A의 가중치나, 사상 B를 표본 공간으로 삼은데서 A의 가중치가 동일하다는 의미이다.  
<br/>
다시 돌아와서,  
$$ P(A) = P(A|S) => P(A|S) = P(A|S)$$  
풀어 말해, 표본공간 S에서 A의 가중치와 표본공간 S에서 A의 가중치는 같다?!  
이제 당연하게 들릴 것이다.  
<br/>

이 동일 가중치의 관계?!가 만족하려면, **두 개의 구별된 표본공간에 있는 각각의 확률변수**를 생각하면 된다. 또는, **하나의 표본공간에 있는 벡터처럼 차원으로 구별되고 Cartesian Product로 구성된 두 개의 확률변수**를 생각해 볼 수 있다.  말이 어려우니 밑의 그림을!  

<br/> 



## 결론

고생했당~!  
<br/>
정리해보자, 사상간의 관계를 표현하는 `배반`과 `독립`은 아래 그림과 같다~!  
<br/>



<br/>
냠냠.

